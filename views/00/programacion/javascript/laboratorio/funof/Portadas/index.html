<!DOCTYPE html>
<html lang="es">

<head>
     <title>Portada</title>

     <meta charset="UTF-8">
     <meta http-equiv="X-UA-Compatible" content="IE=edge">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">

     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

     <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.3.0/dist/sweetalert2.all.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
     <script src="https://code.jquery.com/jquery-3.6.0.js"></script>

     <meta property="og:site_name" content="Portada">
     <meta property="og:title" content="Portada">
     <meta property="og:description" content="Portada funof">
     <meta property="og:image" content="https://i.ibb.co/3vg4KNb/softyo-001.png">
     <link rel="icon" type="image/png" href="https://i.ibb.co/3vg4KNb/softyo-001.png">
</head>

<body>
     <style>
          * {
               transition: all 0.25s;
          }

          body {
               margin: 0;
               padding: 0;
          }
     </style>

     <div style="text-align: center;">
          <label>URL: <input type="text" id="URL" style="width: 90vw;"
                    value="https://docs.google.com/spreadsheets/d/e/2PACX-1vSXsE3awp15MkRChUmgVo60nXPyPHLcH0hCVoMR8FR-kt_w7dWQfBWeUPw9SLwZqg/pub?gid=1864187307&single=true&output=tsv"></label>
          <br>
          <br>
          <div class="btn btn-primary" onclick="guardar()" style="position: fixed;right:5px;bottom: 5px;">
               Guardar
          </div>
          <br>
          <br>
          <div id="element-to-print">
          </div>
     </div>
     <style>
          .hoja {
               width: 21.55cm;
               height: 27.93cm;
               display: inline-flex;
               flex-direction: column;
               justify-content: center;
               align-items: center;
               border: 2px solid black;
               margin:0;
               padding: 0;
          }
     </style>
     <script>
          leerBaseDeDatos()
          function leerBaseDeDatos() {
               document.getElementById("element-to-print").innerHTML = "Cargando..."
               $.ajax({
                    url: document.getElementById("URL").value,
                    success: function (data) {
                         renglones = data.split("\n")
                         console.log(renglones)
                         let html = ""
                         for (let i = 0; i < renglones.length; i++) {
                              if (i <= 1) {
                                   continue
                              }
                              const elementos = renglones[i].split("\t");
                              if (!elementos[1]) {
                                   continue
                              }
                              html += `<div class="hoja">`
                              {
                                   {
                                        html += "<div style='width:4cm;height:4cm;border:5px dashed lightgray;display:flex;justify-content:center;align-items:center;color:lightgray;'>"
                                        html += "<strong>FOTO</strong>"
                                        html += "</div>"
                                   }
                                   html += "<br>"
                                   {
                                        html += "<div>"
                                        html += "<strong>Nombre:</strong> " + elementos[1]
                                        html += "</div>"
                                   }
                              }
                              html += `</div>`
                              if (i < renglones.length - 1) {
                                   html += `<div class="html2pdf__page-break"></div>`
                              }
                         }
                         document.getElementById("element-to-print").innerHTML = html
                    },
               });
          }

          function guardar() {
               var element = document.getElementById('element-to-print');
               var opt = {
                    margin: 0,
                    filename: 'portadas funof.pdf',
                    image: { type: 'jpeg', quality: 1 },
                    html2canvas: {
                         dpi: 192,
                         scale: 1,
                         letterRendering: true,
                         useCORS: true
                    },
                    jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
               };
               html2pdf().from(element).set(opt).save();
          }
     </script>

</body>

</html>